// <auto-generated>
// DO NOT EDIT - Generated by Devian Build System v10
// This file provides server-side runtime for protocol group: Client
// </auto-generated>

import type { IServerProtocolRuntime, SendFn, ICodec } from '@devian/network-server';
import { C2Game } from '../C2Game.g';
import { Game2C } from '../Game2C.g';

/**
 * Server Runtime for Client protocol group
 * 
 * - Inbound: C2Game (client → server)
 * - Outbound: Game2C (server → client)
 */
export class ClientServerRuntime implements IServerProtocolRuntime {
    private readonly stub: C2Game.Stub;
    private readonly codec: ICodec;

    constructor(codec: ICodec) {
        this.codec = codec;
        this.stub = new C2Game.Stub(codec);
    }

    /**
     * Get inbound stub for handler registration
     */
    getStub(): C2Game.Stub {
        return this.stub;
    }

    getInboundOpcodeName(opcode: number): string | null {
        return C2Game.getOpcodeName(opcode) ?? null;
    }

    async dispatchInbound(sessionId: number, opcode: number, payload: Uint8Array): Promise<void> {
        await this.stub.dispatch(sessionId, opcode, payload);
    }

    createOutboundProxy(sendFn: SendFn): Game2C.Proxy {
        return new Game2C.Proxy(sendFn, this.codec);
    }
}

/**
 * Create server runtime for Client protocol group
 */
export function createServerRuntime(codec: ICodec): ClientServerRuntime {
    return new ClientServerRuntime(codec);
}

/** Re-export types for convenience */
export { C2Game, Game2C };