// <auto-generated>
// Unity Prefs - PrefsValue Base Class
// SSOT: skills/devian-unity/10-base-system/24-player-prefs/SKILL.md
// </auto-generated>

using UnityEngine;

namespace Devian
{
    /// <summary>
    /// Abstract base class for PlayerPrefs wrappers.
    /// Provides common key management, HasKey check, and Delete functionality.
    /// </summary>
    /// <typeparam name="T">The value type to store</typeparam>
    public abstract class PrefsValue<T>
    {
        protected readonly string key;
        protected readonly T defaultValue;

        protected PrefsValue(string key, T defaultValue)
        {
            this.key = key;
            this.defaultValue = defaultValue;
        }

        /// <summary>
        /// Returns true if the key exists in PlayerPrefs.
        /// </summary>
        public bool HasKey => PlayerPrefs.HasKey(key);

        /// <summary>
        /// Deletes the key from PlayerPrefs.
        /// </summary>
        public void Delete()
        {
            PlayerPrefs.DeleteKey(key);
        }

        /// <summary>
        /// Gets or sets the value.
        /// Getter: If key doesn't exist, stores defaultValue and returns it.
        /// Setter: Stores the value (does NOT call Save automatically).
        /// </summary>
        public abstract T Value { get; set; }

        /// <summary>
        /// Implicit conversion to T for convenient value access.
        /// </summary>
        public static implicit operator T(PrefsValue<T> obj)
        {
            if (obj == null) return default;
            return obj.Value;
        }
    }
}
