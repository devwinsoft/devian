// <auto-generated>
// Unity Prefs - EnumPrefs (string-based only)
// SSOT: skills/devian-unity/30-unity-components/24-player-prefs/SKILL.md
// </auto-generated>

using System;
using UnityEngine;

namespace Devian
{
    /// <summary>
    /// PlayerPrefs wrapper for enum values.
    /// Stores enum as string (ToString/TryParse) to avoid int reorder issues.
    /// If key doesn't exist on get, stores defaultValue and returns it.
    /// If parsing fails, returns defaultValue.
    /// </summary>
    /// <typeparam name="T">The enum type</typeparam>
    public sealed class EnumPrefs<T> : PrefsValue<T> where T : struct, Enum
    {
        public EnumPrefs(string key, T defaultValue) : base(key, defaultValue) { }

        public override T Value
        {
            get
            {
                if (PlayerPrefs.HasKey(key))
                {
                    var s = PlayerPrefs.GetString(key, defaultValue.ToString());
                    if (Enum.TryParse<T>(s, out var parsed))
                        return parsed;
                    return defaultValue;
                }

                PlayerPrefs.SetString(key, defaultValue.ToString());
                return defaultValue;
            }
            set => PlayerPrefs.SetString(key, value.ToString());
        }
    }
}
