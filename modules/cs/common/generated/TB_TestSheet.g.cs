// <auto-generated>
// DO NOT EDIT - Generated by Devian Build System v10
// </auto-generated>

#nullable enable

using System;
using System.Collections.Generic;
using System.IO;
using System.Text.Json;

namespace Devian.Tables
{
    /// <summary>TestSheet row</summary>
    public sealed class TestSheetRow
    {
        public UserType UserType { get; set; }
        public int Number { get; set; }
        public List<int> IntArr { get; set; } = new();
        public List<string> StringArr { get; set; } = new();
        public List<float> FloatArr { get; set; } = new();
        public UserProfile UserProfile { get; set; }

        public object GetKey() => Number;
    }

    public static partial class Table
    {
        /// <summary>TB_TestSheet container</summary>
        public static class TB_TestSheet
        {
            private static readonly Dictionary<int, TestSheetRow> _dict = new();
            private static readonly List<TestSheetRow> _list = new();

            public static int Count => _list.Count;

            public static void Clear()
            {
                _dict.Clear();
                _list.Clear();
            }

            public static IReadOnlyList<TestSheetRow> GetAll() => _list;

            public static TestSheetRow? Get(int key)
            {
                return _dict.TryGetValue(key, out var row) ? row : null;
            }

            public static bool TryGet(int key, out TestSheetRow? row)
            {
                return _dict.TryGetValue(key, out row);
            }

            public static void LoadFromJson(string json)
            {
                Clear();
                using var doc = JsonDocument.Parse(json);
                foreach (var element in doc.RootElement.EnumerateArray())
                {
                    var row = JsonSerializer.Deserialize<TestSheetRow>(element.GetRawText());
                    if (row == null) continue;
                    _list.Add(row);
                    _dict[row.Number] = row;
                }
            }

            public static void LoadFromNdjson(string ndjson)
            {
                Clear();
                using var reader = new StringReader(ndjson);
                string? line;
                while ((line = reader.ReadLine()) != null)
                {
                    if (string.IsNullOrWhiteSpace(line)) continue;
                    var row = JsonSerializer.Deserialize<TestSheetRow>(line);
                    if (row == null) continue;
                    _list.Add(row);
                    _dict[row.Number] = row;
                }
            }
        }
    }
}