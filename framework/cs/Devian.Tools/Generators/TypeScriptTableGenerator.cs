// <auto-generated>
// Devian Build System - TypeScript Table Generator
// </auto-generated>

using System.Text;
using Devian.Tools.Models;

namespace Devian.Tools.Generators
{
    /// <summary>
    /// Table Spec → TypeScript 코드 생성 (61-tablegen-implementation)
    /// </summary>
    public static class TypeScriptTableGenerator
    {
        /// <summary>
        /// Row Entity 인터페이스 생성
        /// </summary>
        public static string GenerateEntity(TableSpec table)
        {
            var sb = new StringBuilder();
            var interfaceName = $"{table.TableName}Row";

            // Header
            sb.AppendLine("// <auto-generated>");
            sb.AppendLine("// DO NOT EDIT - Generated by Devian Build System");
            sb.AppendLine("// </auto-generated>");
            sb.AppendLine();

            // Interface
            sb.AppendLine($"export interface {interfaceName} {{");

            foreach (var col in table.Columns)
            {
                var tsType = TableTypeMapper.ToTypeScript(col.Type);
                var optional = col.IsOptional && !col.IsKey ? "?" : "";
                sb.AppendLine($"  {col.Name}{optional}: {tsType};");
            }

            sb.AppendLine("}");

            return sb.ToString().TrimEnd();
        }
    }
}
